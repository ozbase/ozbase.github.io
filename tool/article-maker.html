<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>OZBASE 記事作成ツール</title>
<style>
body{font-family:system-ui,sans-serif;max-width:900px;margin:20px auto}
input,textarea,button{width:100%;margin:8px 0;padding:8px}
textarea{height:120px}
code{background:#f5f5f5;display:block;padding:10px;white-space:pre-wrap}
button{font-size:16px}
hr{margin:24px 0}
</style>
</head>
<body>

<h1>記事作成ツール（手入力用）</h1>

<label>記事タイトル</label>
<input id="title">

<label>元記事URL</label>
<input id="source">

<label>サムネイル画像URL（無ければ空）</label>
<input id="thumb">

<label>考察文（AI Analysis）</label>
<textarea id="analysis"></textarea>

<button onclick="generate()">HTMLを生成</button>
<button onclick="download()">/a/ に保存（ダウンロード）</button>

<hr>

<h2>生成されるファイル名</h2>
<code id="filename"></code>

<h2>記事HTML（/a/ 用・完成形）</h2>
<code id="articleHtml"></code>

<h2>トップ用カードHTML（index.html に貼る）</h2>
<code id="cardHtml"></code>

<script>
let articleHTML="", fileName="", cardHTML="";

function generate(){
  const t=document.getElementById("title").value;
  const s=document.getElementById("source").value;
  const th=document.getElementById("thumb").value;
  const a=document.getElementById("analysis").value;

  const d=new Date();
  const y=d.getFullYear();
  const m=String(d.getMonth()+1).padStart(2,"0");
  const day=String(d.getDate()).padStart(2,"0");
  const h=String(d.getHours()).padStart(2,"0");
  const min=String(d.getMinutes()).padStart(2,"0");

  fileName=`${y}${m}${day}-${h}${min}.html`;
  document.getElementById("filename").textContent="a/"+fileName;

  const imgBlock = th ? `
<img src="${th}" alt="">` : ``;

  articleHTML=`<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>${t}</title>
<meta name="robots" content="index,follow">
<link rel="canonical" href="https://ozbase.github.io/a/${fileName}">
<style>
:root{
  --bg:#0b0c10;--fg:#e8e8ea;--muted:#9aa0a6;--link:#8ab4f8;--card:#141824;
}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--fg);
font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,sans-serif;line-height:1.7}
a{color:var(--link);text-decoration:none}
header{
  display:flex;align-items:center;gap:12px;
  padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.08)
}
header img{height:28px}
.back{
  padding:6px 10px;border-radius:999px;
  background:rgba(20,24,42,.8);
  border:1px solid rgba(255,255,255,.08);
  font-size:13px;color:var(--fg)
}
main{max-width:920px;margin:0 auto;padding:24px 16px 64px}
img{display:block;max-width:100%;margin:20px 0;border-radius:14px}
.src{color:var(--muted);font-size:13px;margin-bottom:20px}
footer{
  margin-top:40px;padding-top:20px;
  border-top:1px solid rgba(255,255,255,.08);
  color:var(--muted);font-size:12px
}
</style>
</head>
<body>

<header>
  <a href="/"><img src="/assets/ozbase-logo.png" alt="ozbase"></a>
  <a href="/" class="back">← Back to Top</a>
</header>

<main>

<h1>${t}</h1>

<p class="src">
Source:
<a href="${s}" target="_blank" rel="nofollow noopener">${s}</a>
</p>

${imgBlock}

<h2>AI Analysis</h2>
<p>
${a.replace(/\\n/g,"<br>")}
</p>

<footer>
  <div>© ${y} ozbase</div>
  <div><a href="/privacy.html">Privacy Policy</a></div>
</footer>

</main>

</body>
</html>`;

  const thumbCard = th ? `
  <img src="${th}" alt="" style="width:100%;border-radius:12px;margin-bottom:8px;">` : ``;

  cardHTML=`<div class="card">
${thumbCard}
  <h2>
    <a href="/a/${fileName}">
      ${t}
    </a>
  </h2>
  <p>AI analysis is published on a separate page.</p>
  <div class="src">
    <a href="${s}" target="_blank">${s}</a>
  </div>
</div>`;

  document.getElementById("articleHtml").textContent=articleHTML;
  document.getElementById("cardHtml").textContent=cardHTML;
}

function download(){
  if(!articleHTML){alert("先にHTMLを生成してください");return;}
  const blob=new Blob([articleHTML],{type:"text/html"});
  const url=URL.createObjectURL(blob);
  const a=document.createElement("a");
  a.href=url;
  a.download=fileName;
  a.click();
  URL.revokeObjectURL(url);
}
</script>

</body>
</html>
