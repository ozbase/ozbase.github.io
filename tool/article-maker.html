<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>OZBASE 記事作成ツール</title>
<style>
body { font-family: system-ui, sans-serif; max-width: 800px; margin: 20px auto; }
input, textarea, button { width: 100%; margin: 8px 0; padding: 8px; }
textarea { height: 140px; }
code { background:#f5f5f5; display:block; padding:10px; white-space:pre-wrap; }
button { font-size:16px; }
</style>
</head>
<body>

<h1>記事作成ツール（手入力用）</h1>

<label>記事タイトル</label>
<input id="title">

<label>元記事URL</label>
<input id="source">

<label>サムネイル画像URL</label>
<input id="thumb">

<label>考察文（AI／手動どちらでも）</label>
<textarea id="analysis"></textarea>

<button onclick="generate()">HTMLを生成</button>
<button onclick="download()">/a/ に保存（ダウンロード）</button>

<h2>生成されるファイル名</h2>
<code id="filename"></code>

<h2>生成されたHTML</h2>
<code id="output"></code>

<script>
let generatedHTML = "";
let generatedName = "";

function generate(){
  const t = document.getElementById("title").value;
  const s = document.getElementById("source").value;
  const th = document.getElementById("thumb").value;
  const a = document.getElementById("analysis").value;

  const d = new Date();
  const y = d.getFullYear();
  const m = String(d.getMonth()+1).padStart(2,"0");
  const day = String(d.getDate()).padStart(2,"0");
  const h = String(d.getHours()).padStart(2,"0");
  const min = String(d.getMinutes()).padStart(2,"0");

  generatedName = `${y}${m}${day}-${h}${min}.html`;
  document.getElementById("filename").textContent = "a/" + generatedName;

  generatedHTML = `<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>${t}</title>
<meta name="robots" content="index,follow">
</head>
<body>

<h1>${t}</h1>

<p>
Source:
<a href="${s}" target="_blank" rel="nofollow noopener">
${s}
</a>
</p>

<img src="${th}" alt="" style="max-width:100%;">

<h2>AI Analysis</h2>
<p>
${a.replace(/\n/g,"<br>")}
</p>

</body>
</html>`;

  document.getElementById("output").textContent = generatedHTML;
}

function download(){
  if(!generatedHTML){
    alert("先にHTMLを生成してください");
    return;
  }
  const blob = new Blob([generatedHTML], {type: "text/html"});
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = generatedName;
  a.click();

  URL.revokeObjectURL(url);
}
</script>

</body>
</html>
